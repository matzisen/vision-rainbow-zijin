import{_ as I,r as h,o as N,c as k,d as c,e,f as n,w as y,g as o,u as x,S,h as r,z as T,A as K,b as L,j as m,n as C,t as u,i as _,k as B,U as j,s as z,E as D,v as W}from"./index-Drt15aFz.js";const q={class:"page-wrapper"},F={class:"content-card"},G={class:"card-header"},H={class:"right-panel"},J={class:"search-capsule"},O={class:"table-container"},P={class:"user-profile-cell"},Q={class:"avatar-box"},R={class:"info"},X={class:"nick"},Y={class:"id-row"},Z={class:"date-cell"},ee={key:0},te={class:"pagination-footer"},ae="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",se={__name:"UserManagement",setup(ne){const v=h(!1),p=h([]),d=h(""),g=async()=>{v.value=!0;try{const s=localStorage.getItem("admin_token");let l=(await z.get("/api/admin/users",{headers:{Authorization:s}})).data||[];d.value&&(l=l.filter(i=>i.username.includes(d.value)||i.nickname&&i.nickname.includes(d.value))),p.value=l}catch(s){console.error(s),D.error("获取用户列表失败")}finally{v.value=!1}},b=(s,a)=>{const l=a===0?"封禁":"解封";W.confirm(`确定要${l}用户 ${s.nickname||s.username} 吗？`,"操作确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0,customClass:"warm-theme-box"}).then(async()=>{const i=localStorage.getItem("admin_token");await z.put(`/api/admin/users/${s.id}/status`,{status:a},{headers:{Authorization:i}}),D.success("操作成功"),s.status=a}).catch(()=>{})},M=s=>s?new Date(s).toLocaleDateString():"-";return N(g),(s,a)=>{const l=r("el-icon"),i=r("el-avatar"),U=r("el-tag"),f=r("el-table-column"),w=r("el-button"),V=r("el-table"),$=r("el-pagination"),A=L("loading");return c(),k("div",q,[e("div",F,[e("div",G,[a[1]||(a[1]=e("div",{class:"left-panel"},[e("h2",{class:"page-title"},"用户管理"),e("span",{class:"subtitle"},"管理平台注册用户及其权限状态")],-1)),e("div",H,[e("div",J,[n(l,{class:"search-icon"},{default:o(()=>[n(x(S))]),_:1}),y(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>d.value=t),placeholder:"搜索昵称或账号...",onKeyup:K(g,["enter"])},null,544),[[T,d.value]]),e("button",{onClick:g},"查询")])])]),e("div",O,[y((c(),m(V,{data:p.value,style:{width:"100%"},"header-cell-style":{background:"#fff",color:"#8c9bae",fontWeight:"600",borderBottom:"1px solid #f0f0f0"},"cell-style":{borderBottom:"1px solid #f7f7f7"}},{default:o(()=>[n(f,{label:"用户","min-width":"240"},{default:o(t=>[e("div",P,[e("div",Q,[n(i,{size:48,src:t.row.avatar||ae},null,8,["src"]),e("div",{class:C(["status-indicator",t.row.status===1?"online":"offline"])},null,2)]),e("div",R,[e("div",X,u(t.row.nickname||t.row.username),1),e("div",Y,[_(" ID: "+u(t.row.id)+" ",1),a[3]||(a[3]=e("span",{class:"divider"},"|",-1)),_(" @"+u(t.row.username)+" ",1),t.row.role==="admin"?(c(),m(U,{key:0,size:"small",type:"danger",effect:"plain",class:"admin-tag"},{default:o(()=>[...a[2]||(a[2]=[_("管理员",-1)])]),_:1})):B("",!0)])])])]),_:1}),n(f,{prop:"created_at",label:"注册日期",width:"200"},{default:o(t=>[e("div",Z,[n(l,null,{default:o(()=>[n(x(j))]),_:1}),e("span",null,u(M(t.row.created_at)),1)])]),_:1}),n(f,{label:"账号状态",width:"150"},{default:o(t=>[e("div",{class:C(["status-badge",t.row.status===1?"active":"banned"])},u(t.row.status===1?"正常":"已封禁"),3)]),_:1}),n(f,{label:"操作",width:"120",align:"right",fixed:"right"},{default:o(t=>[t.row.role!=="admin"?(c(),k("div",ee,[t.row.status===1?(c(),m(w,{key:0,type:"danger",link:"",onClick:E=>b(t.row,0)},{default:o(()=>[...a[4]||(a[4]=[_("封禁",-1)])]),_:1},8,["onClick"])):(c(),m(w,{key:1,type:"success",link:"",onClick:E=>b(t.row,1)},{default:o(()=>[...a[5]||(a[5]=[_("解封",-1)])]),_:1},8,["onClick"]))])):B("",!0)]),_:1})]),_:1},8,["data"])),[[A,v.value]])]),e("div",te,[n($,{background:"",layout:"prev, pager, next",total:p.value.length,"page-size":10,disabled:""},null,8,["total"])])])])}}},le=I(se,[["__scopeId","data-v-94ae92bf"]]);export{le as default};
